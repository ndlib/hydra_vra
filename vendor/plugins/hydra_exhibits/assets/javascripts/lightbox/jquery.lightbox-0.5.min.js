(function(a){a.fn.lightBox=function(r){r=jQuery.extend({overlayBgColor:"#000",overlayOpacity:0.8,imageLoading:"/images/lightbox-ico-loading.gif",imageBtnPrev:"/images/lightbox-btn-prev.png",imageBtnNext:"/images/lightbox-btn-next.png",imageBtnClose:"/images/lightbox-btn-close.png",imageBlank:"/images/lightbox-blank.gif",containerBorderSize:10,containerResizeSpeed:400,txtImage:"Image",txtOf:"of",keyToClose:"c",keyToPrev:"p",keyToNext:"n",imageArray:[],activeImage:0,closeCallback:null},r);var j=this;var f=this.parent().children("a[rel=alternate]");function t(){q(this,j);return false}function q(x,w){a("embed, object, select").css({visibility:"hidden"});c();r.imageArray.length=0;r.activeImage=0;if(w.length==1){r.imageArray.push([x.getAttribute("href"),x.getAttribute("title")])}else{for(var v=0;v<w.length;v++){r.imageArray.push([w[v].getAttribute("href"),w[v].getAttribute("title")])}}while(r.imageArray[r.activeImage][0]!=x.getAttribute("href")){r.activeImage++}n()}function c(){a("body").append('<div id="jquery-overlay"></div><div id="jquery-lightbox"><div id="lightbox-container-image-data-box"><div id="lightbox-container-image-data"><div id="lightbox-image-details"><span id="lightbox-image-details-caption"></span><span id="lightbox-image-details-currentNumber"></span></div><div id="lightbox-nav"><a href="#" id="lightbox-nav-btnPrev"><img src="'+r.imageBtnPrev+'"></a><a href="#" id="lightbox-nav-btnNext"><img src="'+r.imageBtnNext+'"></a><a href="#" id="lightbox-nav-btnClose"><img src="'+r.imageBtnClose+'"></a></div></div></div><div id="lightbox-container-image-box"><div id="lightbox-container-image"><img id="lightbox-image"><div id="lightbox-loading"><a href="#" id="lightbox-loading-link"><img src="'+r.imageLoading+'"></a></div></div></div></div>');var v=g();a("#jquery-overlay").css({backgroundColor:r.overlayBgColor,opacity:r.overlayOpacity,width:v[0],height:v[1]}).fadeIn();var w=i();a("#jquery-lightbox").css({top:w[1]+(v[3]/10),left:w[0]}).show();a("#lightbox-loading-link,#lightbox-nav-btnClose").click(function(){b();return false});a(window).resize(function(){var x=g();a("#jquery-overlay").css({width:x[0],height:x[1]});var y=i();a("#jquery-lightbox").css({top:y[1]+(x[3]/10),left:y[0]})})}function n(){a("#lightbox-loading").show();a("#lightbox-image,#lightbox-container-image-data-box,#lightbox-image-details-currentNumber").hide();var v=new Image();v.onload=function(){a("#lightbox-image").attr("src",r.imageArray[r.activeImage][0]);k(v.width,v.height);v.onload=function(){}};v.src=r.imageArray[r.activeImage][0]}function k(y,B){var v=a("#lightbox-container-image-box").width();var A=a("#lightbox-container-image-box").height();var z=(y+(r.containerBorderSize*2));var x=(B+(r.containerBorderSize*2));var w=v-z;var C=A-x;a("#lightbox-container-image-box").animate({width:z,height:x},r.containerResizeSpeed,function(){h()});if((w===0)&&(C===0)){if(a.browser.msie){p(250)}else{p(100)}}a("#lightbox-container-image-data-box").css({width:y})}function h(){a("#lightbox-loading").hide();a("#lightbox-image").fadeIn(function(){m();u()});l();s()}function m(){a("#lightbox-container-image-data-box").show();a("#lightbox-image-details-caption").hide();if(r.imageArray[r.activeImage][1]){a("#lightbox-image-details-caption").html(r.imageArray[r.activeImage][1]+" ").show();a(f[r.activeImage]).clone().removeClass("hidden").appendTo("#lightbox-image-details-caption")}if(r.imageArray.length>1){a("#lightbox-image-details-currentNumber").html(r.txtImage+" "+(r.activeImage+1)+" "+r.txtOf+" "+r.imageArray.length).show()}}function u(){a("#lightbox-nav").show();a("#lightbox-nav-btnPrev>img,#lightbox-nav-btnNext>img").attr("src",r.imageBlank);if(r.activeImage!==0){a("#lightbox-nav-btnPrev>img").attr("src",r.imageBtnPrev).unbind().bind("click",function(){r.activeImage=r.activeImage-1;n();return false})}if(r.activeImage!=(r.imageArray.length-1)){a("#lightbox-nav-btnNext>img").attr("src",r.imageBtnNext).unbind().bind("click",function(){r.activeImage=r.activeImage+1;n();return false})}o()}function o(){a(document).keydown(function(v){d(v)})}function e(){a(document).unbind()}function d(v){if(v===null){keycode=event.keyCode;escapeKey=27}else{keycode=v.keyCode;escapeKey=v.DOM_VK_ESCAPE}key=String.fromCharCode(keycode).toLowerCase();if((key==r.keyToClose)||(key=="x")||(keycode==escapeKey)){b()}if((key==r.keyToPrev)||(keycode==37)){if(r.activeImage!==0){r.activeImage=r.activeImage-1;n();e()}}if((key==r.keyToNext)||(keycode==39)){if(r.activeImage!=(r.imageArray.length-1)){r.activeImage=r.activeImage+1;n();e()}}}function l(){var w=g();var v=(a("#jquery-lightbox").height()+(w[2]/6));if(v>w[2]){a("#jquery-overlay").css({width:w[0],height:v})}}function s(){if((r.imageArray.length-1)>r.activeImage){objNext=new Image();objNext.src=r.imageArray[r.activeImage+1][0]}if(r.activeImage>0){objPrev=new Image();objPrev.src=r.imageArray[r.activeImage-1][0]}}function b(){a("#jquery-lightbox").remove();a("#jquery-overlay").fadeOut(function(){a("#jquery-overlay").remove()});a("embed, object, select").css({visibility:"visible"});if(r.closeCallback!==null){r.closeCallback(r)}}function g(){var v=a(document).width();var x=a(document).height();var w=a(window).width();var y=a(window).height();arrayPageSize=[v,x,w,y];return arrayPageSize}function i(){var w,v;if(self.pageYOffset){v=self.pageYOffset;w=self.pageXOffset}else{if(document.documentElement&&document.documentElement.scrollTop){v=document.documentElement.scrollTop;w=document.documentElement.scrollLeft}else{if(document.body){v=document.body.scrollTop;w=document.body.scrollLeft}}}arrayPageScroll=[w,v];return arrayPageScroll}function p(x){var w=new Date();var v=null;do{v=new Date()}while(v-w<x)}return this.unbind("click").click(t)}})(jQuery);